var grayscale=function(){var e,t,a={colorProps:["color","backgroundColor","borderBottomColor","borderTopColor","borderLeftColor","borderRightColor","backgroundImage"],externalImageHandler:{init:function(e,t){"img"===e.nodeName.toLowerCase()||(o(e).backgroundImageSRC=t,e.style.backgroundImage="")},reset:function(e){"img"===e.nodeName.toLowerCase()||(e.style.backgroundImage="url("+(o(e).backgroundImageSRC||"")+")")}}},r=function(e){return RegExp("https?://(?!"+window.location.hostname+")").test(e)},o=(e=[0],t="data"+ +new Date,function(a){var r=a[t],o=e.length;return r||(e[r=a[t]=o]={}),e[r]}),i=function(e,t,a){var r,n=document.createElement("canvas"),s=n.getContext("2d"),c=e.naturalHeight||e.offsetHeight||e.height,d=e.naturalWidth||e.offsetWidth||e.width;n.height=c,n.width=d,s.drawImage(e,0,0);try{r=s.getImageData(0,0,d,c)}catch(g){}if(t){i.preparing=!0;var f=0;!function(){if(i.preparing){f===c&&(s.putImageData(r,0,0,0,0,d,c),a?o(a).BGdataURL=n.toDataURL():o(e).dataURL=n.toDataURL());for(var t=0;t<d;t++){var g=(f*d+t)*4;r.data[g]=r.data[g+1]=r.data[g+2]=l(r.data[g],r.data[g+1],r.data[g+2])}f++,setTimeout(arguments.callee,0)}}();return}i.preparing=!1;for(var f=0;f<c;f++)for(var m=0;m<d;m++){var u=(f*d+m)*4;r.data[u]=r.data[u+1]=r.data[u+2]=l(r.data[u],r.data[u+1],r.data[u+2])}return s.putImageData(r,0,0,0,0,d,c),n},n=function(e,t){var a=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null)[t]:e.currentStyle[t];if(a&&/^#[A-F0-9]/i.test(a)){var r=a.match(/[A-F0-9]{2}/ig);a="rgb("+parseInt(r[0],16)+","+parseInt(r[1],16)+","+parseInt(r[2],16)+")"}return a},l=function(e,t,a){return parseInt(.2125*e+.7154*t+.0721*a,10)},s=function(e){var t=Array.prototype.slice.call(e.getElementsByTagName("*"));return t.unshift(e),t},c=function(e){if(e&&e[0]&&e.length&&e[0].nodeName){for(var t=Array.prototype.slice.call(e),d=-1,g=t.length;++d<g;)c.call(this,t[d]);return}if(e=e||document.documentElement,!document.createElement("canvas").getContext){e.style.filter="progid:DXImageTransform.Microsoft.BasicImage(grayscale=1)",e.style.zoom=1;return}for(var f=s(e),m=-1,u=f.length;++m<u;){var h=f[m];if("img"===h.nodeName.toLowerCase()){var p=h.getAttribute("src");if(!p)continue;if(r(p))a.externalImageHandler.init(h,p);else{o(h).realSRC=p;try{h.src=o(h).dataURL||i(h).toDataURL()}catch(v){a.externalImageHandler.init(h,p)}}}else for(var y=0,b=a.colorProps.length;y<b;y++){var w=a.colorProps[y],_=n(h,w);if(_){if(h.style[w]&&(o(h)[w]=_),"rgb("===_.substring(0,4)){var C=l.apply(null,_.match(/\d+/g));h.style[w]=_="rgb("+C+","+C+","+C+")";continue}if(_.indexOf("url(")>-1){var I=/\(['"]?(.+?)['"]?\)/,x=_.match(I)[1];if(r(x)){a.externalImageHandler.init(h,x),o(h).externalBG=!0;continue}try{var k=o(h).BGdataURL||function(){var e=document.createElement("img");return e.src=x,i(e).toDataURL()}();h.style[w]=_.replace(I,function(e,t){return"("+k+")"})}catch(L){a.externalImageHandler.init(h,x)}}}}}};return c.reset=function(e){if(e&&e[0]&&e.length&&e[0].nodeName){for(var t=Array.prototype.slice.call(e),i=-1,n=t.length;++i<n;)c.reset.call(this,t[i]);return}if(e=e||document.documentElement,!document.createElement("canvas").getContext){e.style.filter="progid:DXImageTransform.Microsoft.BasicImage(grayscale=0)";return}for(var l=s(e),d=-1,g=l.length;++d<g;){var f=l[d];if("img"===f.nodeName.toLowerCase()){var m=f.getAttribute("src");r(m)&&a.externalImageHandler.reset(f,m),f.src=o(f).realSRC||m}else for(var u=0,h=a.colorProps.length;u<h;u++){o(f).externalBG&&a.externalImageHandler.reset(f);var p=a.colorProps[u];f.style[p]=o(f)[p]||""}}},c.prepare=function(e){if(e&&e[0]&&e.length&&e[0].nodeName){for(var t=Array.prototype.slice.call(e),a=-1,l=t.length;++a<l;)c.prepare.call(null,t[a]);return}if(e=e||document.documentElement,document.createElement("canvas").getContext)for(var d=s(e),g=-1,f=d.length;++g<f;){var m=d[g];if(o(m).skip)return;if("img"===m.nodeName.toLowerCase())m.getAttribute("src")&&!r(m.src)&&i(m,!0);else{var u=n(m,"backgroundImage");if(u.indexOf("url(")>-1){var h=/\(['"]?(.+?)['"]?\)/,p=u.match(h)[1];if(!r(p)){var v=document.createElement("img");v.src=p,i(v,!0,m)}}}}},c}();$(document).ready(function(){if("opera"==r()||"safari"==r()){var e=$(".ticker a img"),t=e.length,a=0;e.one("load",function(){++a==t&&(grayscale($(".ticker a img")),$(".ticker a").hover(function(){grayscale.reset($(this))},function(){grayscale($(this))}))}).each(function(){this.complete&&$(this).trigger("load")})}function r(){var e=navigator.userAgent.toLowerCase();return($.browser.chrome=/chrome/.test(e),$.browser.safari=/webkit/.test(e),$.browser.opera=/opera/.test(e),$.browser.msie=/msie/.test(e)&&!/opera/.test(e),$.browser.mozilla=/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)||/firefox/.test(e),$.browser.chrome)?"chrome":$.browser.mozilla?"mozilla":$.browser.opera?"opera":$.browser.safari?"safari":$.browser.msie?"ie":void 0}function o(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,a=RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=a.exec(t)&&(e=parseFloat(RegExp.$1))}else if("Netscape"==navigator.appName){var t=navigator.userAgent,a=RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");null!=a.exec(t)&&(e=parseFloat(RegExp.$1))}return e}o()>=10&&($(".ticker a img").each(function(){var e=$(this);e.css({position:"absolute"}).wrap("<div class='img_wrapper' style='display: inline-block'>").clone().addClass("img_grayscale").css({position:"absolute","z-index":"5",opacity:"0"}).insertBefore(e).queue(function(){var e=$(this);e.parent().css({width:this.width,height:this.height}),e.dequeue()}),this.src=function e(t){var a=document.createElement("canvas"),r=a.getContext("2d"),o=new Image;o.src=t,a.width=o.width,a.height=o.height,r.drawImage(o,0,0);for(var i=r.getImageData(0,0,a.width,a.height),n=0;n<i.height;n++)for(var l=0;l<i.width;l++){var s=4*n*i.width+4*l,c=(i.data[s]+i.data[s+1]+i.data[s+2])/3;i.data[s]=c,i.data[s+1]=c,i.data[s+2]=c}return r.putImageData(i,0,0,0,0,i.width,i.height),a.toDataURL()}(this.src)}),$(".ticker a").hover(function(){$(this).parent().find("img:first").stop().animate({opacity:1},200)},function(){$(".img_grayscale").stop().animate({opacity:0},200)})),"mozilla"==r()?$("body").addClass("mozilla"):"ie"==r()?$("body").addClass("ie"):"opera"==r()?$("body").addClass("opera"):"safari"==r()?$("body").addClass("safari"):"chrome"==r()&&$("body").addClass("chrome"),o()>=10&&$("body").addClass("ie11")});